<div class="container-fluid">
  <div class="row">
    <!-- Sale Details Form -->
    <div class="col-md-4">
      <h2>Sale Details</h2>
      <form>
        <div class="mb-3">
          <label for="customerName" class="form-label">Customer Name</label>
          <input type="text" id="customerName" class="form-control" [(ngModel)]="sale.customerName" name="customerName" required>
        </div>
        <div class="mb-3">
          <label for="customerAddress" class="form-label">Customer Address</label>
          <textarea id="customerAddress" class="form-control" [(ngModel)]="sale.customerAddress" name="customerAddress"></textarea>
        </div>
        <div class="mb-3">
          <label for="customerMobile" class="form-label">Customer Mobile</label>
          <input type="text" id="customerMobile" class="form-control" [(ngModel)]="sale.customerMobile" name="customerMobile">
        </div>
        <div class="mb-3">
          <label for="saleDate" class="form-label">Date</label>
          <input type="date" id="saleDate" class="form-control" [(ngModel)]="sale.date" name="saleDate">
        </div>
        <div class="mb-3">
          <label for="paymentType" class="form-label">Payment Type</label>
          <select id="paymentType" class="form-select" [(ngModel)]="sale.paymentType" name="paymentType">
            <option *ngFor="let payment of paymentTypes" [ngValue]="payment">{{ payment.name }}</option>
          </select>
        </div>
        <div class="mb-3">
          <label for="paymentRef" class="form-label">Payment Ref #</label>
          <input type="text" id="paymentRef" class="form-control" [(ngModel)]="sale.paymentReferenceNumber" name="paymentReferenceNumber">
        </div>
        <div class="mb-3">
          <label for="deliveryType" class="form-label">Delivery Type</label>
          <select id="deliveryType" class="form-select" [(ngModel)]="sale.deliveryType" name="deliveryType">
            <option *ngFor="let delivery of deliveryTypes" [ngValue]="delivery">{{ delivery.name }}</option>
          </select>
        </div>
      </form>
      <div class="sale-summary mt-3">
        <h4>Total Quantity: {{ sale.totalQuantity }}</h4>
        <h4>Total Price: {{ sale.totalPrice | currency:'INR' }}</h4>
      </div>
      <div class="d-flex justify-content-end mt-3">
        <button type="button" class="btn btn-secondary me-2" (click)="onCancel()">Cancel</button>
        <button type="button" class="btn btn-primary" [disabled]="selectedSaleItems.length === 0" (click)="onCreate()">Create</button>
      </div>
    </div>

    <!-- Product Table -->
    <div class="col-md-8">
      <h2>Products</h2>
      <div class="row g-3 mb-3">
        <div class="col-md-6">
          <input type="text" class="form-control" (keyup)="applyFilter($event)" placeholder="Search by name">
        </div>
        <div class="col-md-6">
          <select class="form-select" (change)="applyFilter($event)">
            <option [value]="'all'">All Categories</option>
            <option *ngFor="let category of categories" [value]="category.name">{{ category.name }}</option>
          </select>
        </div>
      </div>
      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead>
            <tr>
              <th><input type="checkbox" (change)="selectAll($event)"></th>
              <th>ID</th>
              <th>Name</th>
              <th>Category</th>
              <th>Size</th>
              <th>Available</th>
              <th>Quantity</th>
              <th>Price</th>
              <th>Total</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let element of filteredSaleItems | paginate: { itemsPerPage: pageSize, currentPage: pageIndex + 1 }">
              <td><input type="checkbox" (change)="toggleSelection(element)" [checked]="isSelected(element)"></td>
              <td>{{element.productId}}</td>
              <td>{{element.productName}}</td>
              <td>{{element.productCategory}}</td>
              <td>{{element.size}}</td>
              <td>{{element.quantityAvailable}}</td>
              <td><input type="number" class="form-control form-control-sm" [(ngModel)]="element.quantity" min="0" (input)="element.totalPrice = getTotalPrice(element)"></td>
              <td><input type="number" class="form-control form-control-sm" [(ngModel)]="element.salePrice" min="0" (input)="element.totalPrice = getTotalPrice(element)"></td>
              <td>{{ getTotalPrice(element) | currency:'INR' }}</td>
            </tr>
          </tbody>
        </table>
        <pagination-controls (pageChange)="onPageChange($event)"></pagination-controls>
      </div>
    </div>
  </div>
</div>
